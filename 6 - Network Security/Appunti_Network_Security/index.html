
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://bartolialberto.github.io/ComputerNetworks/6%20-%20Network%20Security/Appunti_Network_Security/">
      
      
        <link rel="prev" href="../Approfondimenti/">
      
      
        <link rel="next" href="../../Labs/How%20Colab%20Notebooks%20Work/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.5">
    
    
      
        <title>Appunti - Network Security - Reti di Calcolatori - University of Trieste</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7a7fce14.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-DPWZ1PTD0F"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-DPWZ1PTD0F",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-DPWZ1PTD0F",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#appunti-network-security" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://bartoli.inginf.units.it" title="Reti di Calcolatori - University of Trieste" class="md-header__button md-logo" aria-label="Reti di Calcolatori - University of Trieste" data-md-component="logo">
      
  <img src="../../bernabeu small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Reti di Calcolatori - University of Trieste
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Appunti - Network Security
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://bartoli.inginf.units.it" title="Reti di Calcolatori - University of Trieste" class="md-nav__button md-logo" aria-label="Reti di Calcolatori - University of Trieste" data-md-component="logo">
      
  <img src="../../bernabeu small.png" alt="logo">

    </a>
    Reti di Calcolatori - University of Trieste
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Il Corso
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          1   Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          1   Introduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1%20-%20Introduction/Approfondimenti/" class="md-nav__link">
        Approfondimenti
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1%20-%20Introduction/Appunti_Introduction/" class="md-nav__link">
        Appunti - Introduction
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          2   DNS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          2   DNS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2%20-%20DNS/Approfondimenti/" class="md-nav__link">
        Approfondimenti
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2%20-%20DNS/Appunti_DNS/" class="md-nav__link">
        Appunti - DNS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          3   Web
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          3   Web
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3%20-%20Web/Approfondimenti/" class="md-nav__link">
        Approfondimenti
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3%20-%20Web/Appunti_Web/" class="md-nav__link">
        Appunti - Web
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3%20-%20Web/The%20Big%20Brother/" class="md-nav__link">
        The Big Brother
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          4   Email
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          4   Email
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4%20-%20Email/Approfondimenti/" class="md-nav__link">
        Approfondimenti
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4%20-%20Email/Appunti_Email/" class="md-nav__link">
        Appunti - Email
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          5   IP
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          5   IP
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../5%20-%20IP/Appunti_IP/" class="md-nav__link">
        Appunti - IP
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          6   Network Security
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          6   Network Security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Approfondimenti/" class="md-nav__link">
        Approfondimenti
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Appunti - Network Security
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Appunti - Network Security
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#communication-scenario" class="md-nav__link">
    Communication scenario
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-properties" class="md-nav__link">
    Security properties
  </a>
  
    <nav class="md-nav" aria-label="Security properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-properties" class="md-nav__link">
    Additional properties
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#threat-model" class="md-nav__link">
    Threat model
  </a>
  
    <nav class="md-nav" aria-label="Threat model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#practical-considerations-on-the-scenario" class="md-nav__link">
    Practical considerations on the scenario
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-considerations-on-the-threat-model" class="md-nav__link">
    Practical considerations on the threat model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#insecure-communication-channel" class="md-nav__link">
    Insecure communication channel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-exchange-channel" class="md-nav__link">
    Key exchange channel
  </a>
  
    <nav class="md-nav" aria-label="Key exchange channel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#practical-considerations-on-the-key-exchange-channel" class="md-nav__link">
    Practical considerations on the key exchange channel
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Labs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Labs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Labs/How%20Colab%20Notebooks%20Work/" class="md-nav__link">
        How Colab Notebooks work
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Labs/Web%20Server%20Tests/" class="md-nav__link">
        Web Server Tests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Labs/Wireshark/" class="md-nav__link">
        Wireshark
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          Letture utili per l'esame
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Letture utili per l'esame
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Letture%20utili%20per%20l%27esame/Come%20si%20deve%20svolgere%20un%20esame%20scritto/" class="md-nav__link">
        Come si deve svolgere un esame scritto (e non solo)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Letture%20utili%20per%20l%27esame/Consigli%20da%20chi%20ha%20avuto%20problemi/" class="md-nav__link">
        Consigli di una studentessa che ha avuto difficoltà con l'esame di Reti di Calcolatori
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Letture%20utili%20per%20l%27esame/Consigli%20per%20chi%20non%20ha%20seguito%20le%20lezioni/" class="md-nav__link">
        Consigli per chi non ha seguito le lezioni
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Letture%20utili%20per%20l%27esame/Tentare%20questo%20esame%20molte%20volte/" class="md-nav__link">
        Tentare questo esame molte volte
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
      
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          Questo Corso
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Questo Corso
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Questo%20Corso/Come%20organizzo%20lo%20studio%20di%20Internet/" class="md-nav__link">
        Come organizzo lo studio di Internet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Questo%20Corso/slide%20summary/" class="md-nav__link">
        Argomenti
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#communication-scenario" class="md-nav__link">
    Communication scenario
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-properties" class="md-nav__link">
    Security properties
  </a>
  
    <nav class="md-nav" aria-label="Security properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-properties" class="md-nav__link">
    Additional properties
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#threat-model" class="md-nav__link">
    Threat model
  </a>
  
    <nav class="md-nav" aria-label="Threat model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#practical-considerations-on-the-scenario" class="md-nav__link">
    Practical considerations on the scenario
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-considerations-on-the-threat-model" class="md-nav__link">
    Practical considerations on the threat model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#insecure-communication-channel" class="md-nav__link">
    Insecure communication channel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-exchange-channel" class="md-nav__link">
    Key exchange channel
  </a>
  
    <nav class="md-nav" aria-label="Key exchange channel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#practical-considerations-on-the-key-exchange-channel" class="md-nav__link">
    Practical considerations on the key exchange channel
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="appunti-network-security">Appunti - Network Security</h1>
<h2 id="communication-scenario">Communication scenario</h2>
<p>We consider a large set of <em>subjects</em> communicating among themselves. Each subject has a <em>name</em> in the form of a string. A <em>message </em>is a sequence of bytes associated with the subject that constructed the sequence. The association may be encoded in the message either explicitly or implicitly. We say that a sequence of bytes contains a subject to mean that it contains the name of that subject.</p>
<p>The nature of subjects, of the communication channel, of messages and the format of names are irrelevant and depend on the specific application.</p>
<p>In practical scenarios, a subject may be an organization, an individual, a computer and so on. Messages may be frames, packets, byte streams, application messages, emails, files and so on. The communication channel may be a network, a file system, a person carrying a memory pen and so on.  A subject name may be an Ethernet address, an IP address, a DNS name, an email address, a username, a fiscal code, an X509 tuple and so on.</p>
<p>Subjects may be distributed worldwide and may belong to many different organizations. We assume that the set of subjects is “very large”; the composition of this set may vary dynamically and is not known to any entity.</p>
<h2 id="security-properties">Security properties</h2>
<p>We aim at obtaining one or more of the <em>security properties</em> described below, despite the presence of an adversary (an <em>attacker</em>) that actively attempts to deny these properties. The actions that can be executed by the adversary (<em>threat model</em>) are described in a later section.</p>
<ul>
<li><em>Secrecy</em> (also called <em>Confidentiality</em>). A message can be understood only by its intended recipient.</li>
<li><em>Integrity</em>. Let m be a message constructed at time t1 and used at time t2. Any difference between the content of m at t1 and its content at t2 is detected.</li>
<li><em>Authentication</em>. Let m be a message carrying an explicit or implicit indication that has been constructed by subject S. If the subject that constructed m is not S, this discrepancy is detected.</li>
</ul>
<h3 id="additional-properties">Additional properties</h3>
<p>Other security properties very important in practice are the following.
* <em>Non repudiation</em>. Let m be a message constructed by subject S. Assume that S claims to not have constructed m, or to have constructed m with a different content. Any subject can detect that the claim is false.
* <em>Timestamp</em>. Integrity, augmented with the ability for any subject to determine that m indeed existed at t1.
* <em>Availability</em>. When two subjects need to communicate they are indeed able to communicate.</p>
<p>Non-repudiation and timestamp are essential properties for any commercial and/or legally binding operation. Availability is an essential property in any scenario.</p>
<p>These properties are not considered in this course.</p>
<h2 id="threat-model">Threat model</h2>
<p>We consider a<em> threat model</em> with a <em>network attacker</em>. A network attacker is a subject with the ability to observe, modify, discard any message at any time instant. The network attacker is also able to construct a sequence of bytes and transmit it as a message at any time instant.</p>
<p>How a subject may acquire the ability to operate as a network attacker is irrelevant.</p>
<p>It is simple to realize that <em>none</em> of the protocols analyzed so far in this course provide <em>any</em> security property with this threat model.
* Secrecy (the attacker may observe any message);
* Integrity (the attacker may modify any message and the modification will be undetected by the recipient);
* Authentication (the attacker may forge a message and associate it with any subject; the attacker may modify a message that carries an explicit association with a subject and replace that subject with any subject).
Note that the above considerations apply to protocols at all levels: network, internetwork, application</p>
<p>Unless specified otherwise, in the following we will use the term attacker as a synonym for network attacker.</p>
<h3 id="practical-considerations-on-the-scenario">Practical considerations on the scenario</h3>
<p>There is a myriad of different protocols and applications that use cryptographic techniques for obtaining security properties.</p>
<p>Some of those protocols and applications are: HTTPS, TLS, SSH (a protocol for remote login and remote network access), digital signatures on executable files, legally binding digital signatures on documents, DKIM (a protocol for detecting falsified sender email addresses), “Posta Elettronica Certificata”, Kerberos (a protocol used in enterprise networks based on Windows), NTLM (a protocol used in networks based on Windows), DNSSEC (a protocol for digitally signing DNS records), IPSEC, VPN, WPA Personal (the protocol for secure wi-fi communication used in our homes and in all public locations in which all devices connect with the same password), WPA Enterprise (the protocol for secure wi-fi communication used in enterprise networks including eduroam), Windows Update, Android PlayStore, WhatsApp,  WhatsApp Web, chip-and-pin bancomat cards, SIM authentication in cellular phone networks, disk encryption, PGP, and so on, and so on.</p>
<p>We will analyze in detail only HTTPS and TLS. The fundamental concepts that we describe for these protocols apply to all the other cases.</p>
<h3 id="practical-considerations-on-the-threat-model">Practical considerations on the threat model</h3>
<p>In practical scenarios, a network attacker could have a <em>subset </em>of the abilities assumed here. It could perform a subset of actions (for example only observe and not modify or discard). It could operate on a subset of messages (for example only those between specific subjects, or only in one direction, or only those of a specific application protocol). It could operate only at some time instants or time intervals. Furthermore, in a practical scenario there could even be no network attacker at all.</p>
<p>On the other hand, subjects do not know whether a network attacker is present and what he can do. Furthermore, the presence of a network attacker is detected, if at all, after a long time. Thus, secrecy, integrity and authentication guarantees can only be obtained by assuming that a network attacker with full capabilities is indeed present.</p>
<p>Note that we assume that the network attacker may operate <em>only </em>on the communication channel. The endpoints are thus assumed to be outside of the reach of the attacker.</p>
<p>In practical scenarios this assumption is often not verified (for example when a node has a malware or an attacker knows a password). In those cases, the protocols and mechanisms described here will <em>not</em> provide the desired security properties. For example, if the attacker can read information on the communicating endpoints, then the attacker can obtain keys of private key cryptography and private keys of public key cryptography: it is simple to realize from the discussions below that in those cases secrecy and authentication will not be provided (the attacker can decrypt messages and construct messages whose authorship will be attributed to the subject from which the private key has been stolen).</p>
<p>The fact that, in practice, attackers may operate on the endpoints is a huge practical problem that will not be considered in this course.</p>
<h2 id="insecure-communication-channel">Insecure communication channel</h2>
<p>Let C denote a communication channel where an attacker may be present. We aim at obtaining security properties on C by using cryptographic techniques.</p>
<p>Consider two subjects A and B that can communicate <em>only</em> through C.</p>
<p>Suppose A and B want to agree on a key K-AB for private key cryptography. There is no way for them to agree on a key without making that key potentially known to the attacker (C does not provide secrecy). Once the attacker knows K-AB, no security property can be obtained based on that K-AB.</p>
<p>Suppose B has a private-public key pair for public key cryptography and wants to “send its public key” to A (i.e., to send the association <code>&lt; B , KPUB-B &gt;</code>). There is no way to make sure that A receives the real association <code>&lt;B , KPUB-B&gt;</code> rather than a false association <code>&lt;B, KPUB-Attacker&gt;</code> (C does not provide integrity).</p>
<p>Once the attacker has convinced A that KPUB-Attacker is the public key of B, the attacker can:</p>
<ul>
<li>Sign documents that A will validate as having been signed by B; </li>
<li>Decrypt messages that A will believe can be decrypted only by B;</li>
</ul>
<p>In summary, obtaining security properties by communicating only on a channel that does not have these properties already is <strong>impossible</strong>, even by using cryptographic techniques.</p>
<h2 id="key-exchange-channel">Key exchange channel</h2>
<p>We assume the existence of an <em>additional </em>communication channel CS with the following properties:
- CS provides guarantees of secrecy, integrity, authentication.
- CS may be used only for secure communication of keys.</p>
<p>Intuitively, communication on CS is secure but very costly. Thus, CS cannot be a replacement for C (of course, if subjects could exchange messages on CS then there would be no need of adding security guarantees to C: subjects would use CS).</p>
<p>The nature of CS is irrelevant and need not be the same for all pairs of subjects. In practical scenarios, CS could be a face to face meeting, a diplomatic courier or other forms of secure by definition channel.</p>
<h3 id="practical-considerations-on-the-key-exchange-channel">Practical considerations on the key exchange channel</h3>
<p>An implementation of CS cannot provide secrecy, integrity, authentication with absolute and provable certainty.</p>
<p>CS must be implemented so that attacks are very costly. However, it is impossible to <em>prove </em>that CS indeed provides the required security properties. One can only obtain a high <em>degree of confidence</em> on the fact that CS provides those properties even in the presence of attacks. The notion of degree of confidence cannot be quantified and is intrinsically different from a mathematical proof.</p>
<p>Once an implementation of CS is used in practice, CS is <em>assumed </em>to provide the required security properties: it provides secrecy, integrity and authentication by hypothesis.</p>
<p>For example, in a face to face meeting in which A generates a private key on his computer and passes this key to B on a memory pen, one of the two computers could have a malware that allows the attacker to know that key. There is no way to prove that this is not the case.</p>
<p>As another example, in a face to face meeting in which A obtains from B his public key, the computer of A could have a malware that modifies that public key; or, the computer that B used for writing in the memory pen could have had a malware that modified the public key.</p>
<h1 id="secure-communication-over-an-insecure-channel">Secure communication over an insecure channel</h1>
<p>Let C and CS denote the communication channels described above. We aim at obtaining security properties on C by means of cryptographic techniques and keys exchanged on CS.</p>
<p>The protocols for key exchange and secure communication described below are strong oversimplifications of what needs to be done in real protocols. The corresponding issues are not considered in this course.</p>
<h3 id="private-key-cryptography">Private key cryptography</h3>
<p>Two subjects A and B could obtain secrecy, integrity, authentication on C as follows:
1. Choose a key K-AB on CS
2. Communicate on C using K-AB, i.e., send each message m as EK-AB(m),MACK-AB(m).</p>
<p>Procedures of this kind are impractical because of step 1:</p>
<ul>
<li>CS should exist between <em>all </em>pairs of subjects.</li>
<li>The time required for completing the key exchange on CS should be sufficiently short.
Satisfying these fundamental requirements in a scenario characterized by a very large and geographically distributed set of subjects is virtually impossible.</li>
</ul>
<p>Procedures of this kind were the norm before the Internet and now are only used in very specific settings, usually characterized by a small set of subjects.</p>
<p>The Kerberos protocol is based on private key cryptography, allows handling large sets of subjects and is widely used in practice (it is the basis of Windows enterprise networks). Kerberos is not structured as above and is not studied in this course.</p>
<h3 id="public-key-cryptography">Public key cryptography</h3>
<p>We assume that each subject has a public-private key pair and that different subjects have different key pairs.</p>
<p>Two subjects A and B could obtain secrecy, integrity, authentication on C as follows:</p>
<ol>
<li>Exchange the respective associations <Subject, KPUB> on CS</li>
<li>Choose a key K-AB on C by means of public key cryptography (italic font indicates an encryption with public key cryptography):</li>
<li>A selects half-key K1 and sends <em>E</em>KPUB-B(K1) to B</li>
<li>B selects half-key K2 and sends <em>E</em>KPUB-A(K2) to A</li>
<li>Each party decrypts the received message with the respective private key (i.e., the one of the public-private key pair) and constructs K-AB as the concatenation of K1 and K2.</li>
<li>Communicate on C using K-AB, i.e., send each message m as EK-AB(m),MACK-AB(m).</li>
</ol>
<p>Note that step 1 must be executed on CS although it involves the exchange of public data. The reason is because the exchanged information must have integrity and authentication guarantees. If this step was executed on C, then the attacker could convince subjects to use wrong associations between subjects and public keys (the attacker could send <code>&lt;A, KPUB-Attacker&gt;</code> to B or <code>&lt;B, KPUB-Attacker&gt;</code> to A). At steps 2 and 3, thus, the attacker could communicate with A by pretending to be B and/or the other way around.</p>
<p>At step 2, each party proves to the other the knowledge of a private key: A proves to B that it is able to decrypt <em>E</em>KPUB-A(K2); B proves to A that it is able to decrypt <em>E</em>KPUB-B(K1). Thus, this step ensures <em>mutual authentication</em> based on public key cryptography.</p>
<p>This procedure is impractical because of step 1, for the same reasons discussed above with respect to private key cryptography: CS should exist between any pair of subjects; communication on CS should be sufficiently fast.</p>
<p><strong>Remark:</strong> TLS in its default configuration assumes that <em>only one</em> of the two subjects has a private-public keypair. Here we have assumed instead that <em>both </em>subjects have a keypair. TLS is discussed in a later section in this document. The scenario assumed in this section corresponds to TLS with mutual authentication, i.e., both the client and the server authenticate the respective identity with cryptographic means. This configuration of TLS is non default and used rarely.</p>
<h3 id="validating-digital-signatures">Validating digital signatures</h3>
<p>A document is a sequence of bytes. A <em>signed</em> document is a document associated with a signature (a sequence of bytes of fixed length) and with the name of the signing subject. In practice, these three pieces of information are usually represented as a single byte sequence, for example a file. The corresponding protocol is irrelevant.</p>
<p>Let A be a subject that receives a signed document &lt; D, F, Signed by=B&gt;, where F denotes the signature. A validates the digital signature as follows:
1. Obtain the public key of the signing subject B from CS (i.e., the association &lt; B, KPUB-B&gt;)
2. Validate the signature with  &lt; D, F, KPUB-B&gt;</p>
<p>Note that A receives the signed document on the insecure channel C.</p>
<p>Note that step 1 must be executed on CS although it involves the exchange of public data. The reason is because the exchanged information must have integrity and authentication guarantees. If this step was executed on C, then the attacker could convince A to use the association <B, KPUB-Attacker>. The attacker could thus sign documents that A will believe have been signed by B: the attacker will sign with KPRIV-Attacker and the signature validation at step 2 will succeed.</p>
<p>This procedure is impractical because of step 1, for the same reasons discussed above: CS should exist between any pair of subjects; communication on CS should be sufficiently fast.</p>
<h1 id="public-key-cryptography-with-certification-authorities">Public key cryptography with certification authorities</h1>
<p>We augment the considered scenario with three assumptions, described in  the next sections. The resulting scenario models <em>all </em>the practical applications of public key cryptography. In this augmented scenario:
* Any subject may securely send “its public key” to any other subject by communicating <em>only on C</em> (not on CS).
* Any two subjects may securely choose a key for private key cryptography by communicating <em>only</em> on C (not on CS).</p>
<p>In other words, any two subjects may thus establish a secure channel on C by only communicating on C itself, that is, by communicating only on the channel that they do not trust.</p>
<p>The two requirements that made the previous procedure impractical are no longer required:
* A secure channel CS should exist between <em>all </em>pairs of subjects.
* The time required for completing the key exchange on CS should be sufficiently short.
Intuitively, communication on CS is required only “at the beginning” and with a small set of subjects (the certification authorities). Having executed this costly-but-secure interaction once, there is no need to communicate on CS again and all communications may occur on C.</p>
<h2 id="certificates-and-certification-authorities">Certificates and certification authorities</h2>
<p>A <em>certification authority</em> is a subject that attests (certifies) the public key of other subjects.</p>
<p>We assume that each subject interacts with a certification authority for proving that it is associated with a specified name A (i.e., that it has the right to impersonate subject A) and a specified public key KPUB-A. The details of this procedure are irrelevant and depend on the specific certification authority.</p>
<p>If the proof satisfies the certification authority, then the certification authority constructs a file <A, KPUB-A> and signs this file with its own private key. This file is called a <em>certificate</em> and contains an indication of the certification authority that constructed the file, that is, of the <em>issuer </em>of the certificate. We denote certificates as &lt; Subject, KPUB, Issuer &gt; (the signature is implicitly present), meaning that the certificate contains the association between the specified subject and specified public key, the association has been verified by the specified issuer and the issuer has signed the certificate with its own private key.</p>
<p>Note that certificates contain public information and thus need not be confidential or secret. Any subject can have a copy of the certificate of any other subject. Clearly, for any certificate, there will be only one subject whose private key is the companion of the public key in the certificate.</p>
<p>There are a few different standards for the format of certificates. The most important one is X.509. In this standard, subjects and issuers are described by means of a set of named strings: common name, organizational unit, organization, country and others. The rules for actually choosing these values are part of the protocol specification.</p>
<h2 id="keyset-and-trustset">KeySet and TrustSet</h2>
<p>We assume that each subject obtains on CS the association <Subject-i, KPUB-i> for a small set of certification authorities. We call the set of these associations <em>KeySet</em> of the subject. In practical scenarios, the KeySet is part of the operating system.</p>
<p>Let S be a subject whose KeySet contains &lt; CA-X, KPUB-X &gt;. S may verify signatures made by CA-X, thus S may verify authenticity and integrity of certificates issued by S. These properties are guaranteed even for certificates that S receive on C, i.e., on the insecure channel..</p>
<p>Authenticity and integrity of a signed sequence of bytes do not imply that the sequence of bytes represents a true proposition or a real fact. In particular, “authenticity” does not mean “the signed content is true”: it means that the content has been signed with the private key companion of the public key used in verification.</p>
<p>A certification authority could thus sign a false association between a subject and a public key. It follows that a certificate may contain a false association between a subject and a public key, even though the signature on the certificate is verified.</p>
<p>We assume that each subject has a small set of subjects representing certification authorities that are <em>trusted </em>by that subject. A certificate issued by a trusted certification authority is assumed to contain real associations. We call this set <em>TrustSet</em>. In practical scenarios, the TrustSet is part of the operating system.</p>
<p>In summary, we augment the considered scenario by assuming that each subject:
1. Has a certificate for its public key.
2. Obtains on CS the public keys of certification authorities (KeySet).
3. Chooses a set of trusted certification authorities (TrustSet).
The resulting scenario models all the practical applications of public key cryptography.</p>
<p>For practical reasons, a certificate has an <em>expiration date</em> chosen and signed by the issuer. The certificate cannot be used after that date.</p>
<h2 id="sending-public-keys-on-an-untrusted-channel">Sending public keys on an untrusted channel</h2>
<p>In this augmented scenario, <em>any </em>subject may send “its public key” to<em> any other subject </em>by communicating <em>only on C</em> (not on CS). The procedure is as follows.</p>
<p>Let A be the sending subject. Let B the receiving subject and let KeySet-B, Trust-Set-B denote the corresponding KeySet and TrustSet.
1. A sends “its certificate” to B: &lt; S=A, KPUB=KPUB-A, I=CA-A&gt;
2. B verifies that it can use the certificate:
 1. CA-A belongs to TrustSet-B.
 2. CA-A belongs to KeySet-B
3. B validates the certificate:
 3. verifies the signature on the received certificate with the public key of the issuer, obtained in KeySet-B (i.e., by using &lt; CA-A, KPUB-CA-A&gt;).
 4. verifies that the certificate has not expired.</p>
<p>If all the checks succeed, then B knows that the public key of A is the one in the received certificate.</p>
<p>If any of the checks fails, then B cannot use the received certificate and thus does not know the public key of A (step 2-a: B does not assume that the association encoded by the certificate is real; step 2-b: B cannot verify the signature on the certificate; step 3-a: the certificate has no authentication and integrity guarantees).</p>
<p>Necessary condition for using a certificate, thus, is that the issuer of the certificate belongs to both the KeySet and TrustSet of the subject willing to use that certificate.</p>
<h2 id="securing-the-insecure-channel">Securing the insecure channel</h2>
<p>Two subjects A and B may obtain secrecy, integrity, authentication on C by replacing only step 1 of the procedure based on public key cryptography described before the augmented scenario. The resulting procedure is as follows:
1. Exchange the respective certificates on C
2. Choose a key K-AB on C by means of public key cryptography
3. Communicate on C using K-AB, i.e., send each message m as EK_AB(m),MACK-AB(m)</p>
<p>An attacker could attempt to impersonate A as follows (the reasoning for the attempt of impersonating B is identical):
1. <em>Send the real certificate of A</em>. In this case the attacker cannot decrypt the key that B will choose and send encrypted with the public key of A (step 2).
2. <em>Modify the certificate of A by replacing KPUB-A with the attacker’s public key</em>. In this case when B will verify the signature on the certificate, the verification will fail because there is no integrity.
3. <em>Forge a certificate that associates A with the attacker’s public key</em>. In this case when B will verify the signature on the certificate, either the verification will fail because there is no authenticity (if the attacker forges a certificate whose issuer is in the KeySet of B) or the certificate cannot be verified (if the issuer is not in the KeySet of B).
An attacker could attempt other attacks (for example on CS, or on the content of KeySets and TrustSets) but those attacks are based on a different threat model, that is, they require abilities different from those assumed here. The three attacks outlined above summarize all the attacks that can be done by a network attacker.</p>
<p>Any two subjects may thus establish a secure channel on C by only communicating on C itself, that is, by communicating only on the channel that they do not trust. All that is needed is a communication on CS “only at the beginning” and only for initializing the respective KeySet and TrustSet (in practice, this communication on CS corresponds to installing an operating system from a trusted source).</p>
<h1 id="tls-transport-layer-security">TLS (Transport Layer Security)</h1>
<h2 id="security-guarantees-and-implementation">Security guarantees and implementation</h2>
<p>TLS provides secrecy, integrity and server authentication on top of TCP connections.</p>
<p>These guarantees are obtained with the procedures based on public key cryptography with certification authorities. The key difference with the description in the previous sections is that in the default TLS configuration:
* The server has a private-public key pair and authenticates with public key cryptography.
* Clients need not have any private-public key pair and do not authenticate.</p>
<p>The corresponding procedure is as follows (this is a much oversimplified description of the real TLS protocol):
1. Client opens a TCP connection with Server.
2. Client sends the name of the Server.
3. Server sends its certificate &lt; S=ServerSubject, KPUB=KPUB-S, I=CA &gt;.
4. Client validates received certificate.
5. Client verifies that received certificate is for the expected subject (the one specified at step 1).
6. Client chooses a key K and sends  <em>E</em>KPUB-S(K) to Server.
7. Client and Server communicate using K, i.e., send each message m as EK(m),MACK(m)</p>
<p>In principle, any application protocol based on TCP can be used on TLS. After executing steps 1-5, client and server will interact as specified by the application protocol. This is what happens, for example, in HTTPS.</p>
<p>To understand the need for step 2 consider a scenario in which a given server has several names and hosts a websites for each such name. In this case the server must have a different keypair and certificate for each name. Without step 2, the server would not know which certificate to send at step 3.</p>
<p>To understand the need for step 5, consider the following example. At step 1 the client contacts the DNS for obtaining the IP address of “server.com”; the network attacker could falsify the DNS response, thus the client would open a TCP connection with the attacker. Suppose the network attacker has a valid certificate. This certificate will be for a subject different from "server.com" because the attacker does not have the right to use that name, thus (by hypothesis) no certification authority will issue a certificate for that subject name to the attacker. Without step 4, steps 2-6 would complete successfully, irrespective of the subject contained in the certificate of the Attacker: thus the Client would believe to be connected to “server.com” while in fact it is connected to the Attacker.</p>
<p>It is thus necessary to bind the Server identity as specified by the Client in step 1, to the server identity as contained in the certificate. In principle, the “subject” field of a certificate could be a DNS name. The certification authority would check that the subject requesting the certificate has the right to use that DNS name; and, clients would verify at step 5 that the subject in the received certificate matches the DNS name specified at step 1.</p>
<p>In practice, the “subject” field of a certificate is not a DNS name. A certificate contains a name called “Subject Alternative Name” whose value is a list of DNS names. These names are used as described in the previous paragraph (more details can be found in <a href="https://bartoli-alberto.blogspot.com/2018/12/https-dettagli-sulla-autenticazione-del.html">this</a> blog post). In this course we may assume that the subject field of a certificate is a DNS name.</p>
<h2 id="understanding-server-authentication">Understanding server authentication</h2>
<p>Consider a website on server <code>goodsite.com</code> at address <code>IP-good</code>. Consider an attacker with a website on server <code>badsite.com</code> at address <code>IP-bad</code>. We explore the various options available to the attacker to impersonate <code>goodsite.com</code> , that is, to trick browsers that want to connect to <code>goodsite.com</code> to actually connect to the attacker’s website.</p>
<p>The browser connects to <code>http://goodsite.com</code>.
1. Browser sends DNS request for obtaining IP address of goodsite.com
2. Attacker spoofs DNS response and responds with IP-bad.
3. Browser connects to IP-bad, 80.
4. TCP connection opens.
5. Browser sends HTTP request to Attacker and Attacker responds.
The attack thus succeeds. The address bar on the browser will show <code>http://goodsite.com</code> but the content will be provided by the Attacker. This fact is not surprising because http does not provide server authentication.</p>
<p>Many websites are available both on http and on https. When a browser attempts to connect on http, the website responds with a redirection to https. The above attack succeeds irrespective of whether <code>goodsite.com</code> is available only on https or on both http and https.</p>
<p>The browser connects to <code>https://goodsite.com</code>.
1. Browser sends DNS request for obtaining IP address of goodsite.com
2. Attacker spoofs DNS response and responds with IP-bad.
3. Browser connects to IP-bad, 443.
At this point there are the following possibilities:
* Attacker does not have https site.
 * The TCP connection will not open, because the Attacker web server is not listening on port 443.
* Attacker has a valid certificate for <code>badsite.com</code>.
 * TCP Connection opens, Attacker sends certificate, Browser detects that the certificate is not for <code>goodsite.com</code> and closes the connection.
* Attacker has a copy of the certificate of <code>goodsite.com</code> (any subject may obtain a copy of this certificate, for example by connecting to the real <a href="https://goodsite.com">https://goodsite.com</a>).
 * TCP Connection opens, Attacker sends certificate, Browser sends a private key encrypted with the public key in that certificate. Attacker cannot decrypt, thus communication will not proceed and the connection will close.
* Attacker obtains a certificate for <code>goodsite.com</code> from a certification authority in the KeySet and TrustSet of the browser.
 * This fact cannot occur by hypothesis.</p>
<p>Thus, if a browser follows an https URL then the browser is guaranteed that the web server is authentic. This means that:
* <em>The content shown by the browser is indeed provided by the web server whose DNS name appears in the browser address bar.</em></p>
<p>A big practical problem occurs because browsers often follow URLs received in email messages or found in other web pages. In these cases a browser may connect to an attacker-controlled website (<code>https://badsite.com</code>) whose appearance may be identical to that of another website (<code>https://goodsite.com</code>). In particular, the attacker-controlled website could replicate the login page of <code>https://goodsite.com</code>. Although the address bar of the browser will show <code>https://badsite.com</code>, users that forget to check the address bar or are not able to perform that check correctly will send their credentials for <code>goodsite.com</code> to <code>badsite.com</code>, i.e., to the attacker (phishing). Of course, the attacker could choose for its website an URL syntactically similar to the URL to attack.</p>
<p>Note that the attacker-controlled website is https and its appearance is identical to the appearance of another website, also https. This fact does <em>not </em>violate the server authentication property described above. From a different point of view, https does not provide any guarantee on “which data” will be sent within the TCP connection by the web server.</p>
<h2 id="client-authentication">Client authentication</h2>
<p>In the default TLS configuration, client authentication is not provided. Clients may authenticate with the mechanisms specified by the application-level protocol. For example, in HTTPS, they may authenticate with BASIC or FORM authentication and the corresponding network traffic will have the security guarantees provided by TLS.</p>
<p>Application-level authentication mechanisms involve the use of a client password. This fact introduces many practical problems because:
* The client can be tricked to send the password to an Attacker (phishing);
* The password of all the clients must be known to the server; an attacker could manage to steal all the passwords from the server.</p>
<p>A TLS server may be configured with mutual authentication. In this case clients must have a private-public key pair. When the server sends its certificate, it specifies that mutual authentication is required. The resulting procedure is as follows:
1. Client opens a TCP connection with Server.
2. Server sends its certificate &lt; S=ServerSubject, KPUB=KPUB-S, I=CA &gt; and requires mutual authentication.
3. Client validates received certificate.
4. Client verifies that received certificate is for the expected subject.
5. Client chooses a key K and sends  <em>E</em>KPUB-S(K) to Server and sends its certificate &lt; C = ClientSubject, KPUB=KPUB-C, I =CA-C&gt;.
6. Server validates received certificate.
7. Server chooses a key K1 and sends  <em>E</em>KPUB-C(K1) to Client
8. Client and Server communicate using K concatenated with K1</p>
<p>The client identity at the application protocol will be the subject in the client certificate and the application will consider the client as authenticated. The details for passing this information from TLS to the application are irrelevant.</p>
<p>Using TLS with mutual authentication removes the password problems completely, because the client secret (its private key) never leaves the client device:
* The client cannot be tricked to send its private key to an Attacker (because the client never sends its private key);
* The private key of clients is not known to the server, thus the Attacker cannot steal all those keys from the server.</p>
<p>In other words, a client authenticates to the server by demonstrating that it knows a secret. In the case of passwords, the server must know the secret and this fact leads to important practical problems. In the case of public key cryptography, the server need not know the secret thus the corresponding problems are eliminated. The reason why the server need not know the secret is this: the server constructs a problem that only the client can solve and such that the server can verify it has been solved (“decrypt this number: <em>E</em>KPUB-C(K1)”)</p>
<p>The reason why TLS with mutual authentication is rarely used despite its advantages is because managing the credential lifecycle when credentials are key pairs is much more costly and more difficult than when credentials are passwords.</p>
<h2 id="personalset">PersonalSet</h2>
<p>A subject with a private-public key pair needs to store this information.</p>
<p>The public key is always associated with the name of that subject, in a certificate issued by a certification authority. While the certificate may be read by any subject, the private key obviously must be readable only by the subject associated with that private key.</p>
<p>We denote by <em>PersonalSet </em>the set containing the private-public key pair of a subject. The content of this set must be carefully protected from fraudulent accesses. The actual implementation of the PersonalSet depends on the operating system. In practice, this set appears with terminology and structure different from the one used in this document. The corresponding storage may be a file stored in the device or in a smartcard.</p>
<p>Note that the PersonalSet cannot be kept always offline: the private key must be accessible to the software that needs to sign documents or to decrypt messages encrypted with the matching public key.</p>
<p>In most cases, the PersonalSet is empty: most users need not sign documents; most users need not authenticate with public key cryptography. Of course, web servers available on https must have a non-empty PersonalSet.</p>
<p>In some cases a PersonalSet could contain multiple key pairs. This occurs when a device may impersonate multiple subjects or when a subject may use multiple key pairs (in practice, a key that can be used for signing documents cannot be used for authentication with public key cryptography; the reasons are not part of this course).</p>
<h1 id="practical-considerations">Practical considerations</h1>
<h2 id="certification-authorities">Certification authorities</h2>
<p>It cannot be proved with absolute (mathematical) certainty that a certification authority only certifies real associations.</p>
<p>Certification authorities must use procedures that even in the presence of mistakes or attacks never end up in certifying false associations. However, it is impossible to <em>prove </em>that such events never occur. One can only obtain a high <em>degree of confidence</em> on the fact that a certification authority only certifies real associations.</p>
<p>Once a subject considers that a certification authority is trusted, the subject assumes that all certificates with a valid signature issued by that authority describe real associations.</p>
<h2 id="key-pair-generation">Key pair generation</h2>
<p>In principle, a subject could generate a private-public key pair and then interact with a certification authority to have a certificate for his/her public key.</p>
<p>In practice, key pairs are generated by certification authorities. A subject interacts with a certification authority not only for obtaining a certificate but also for obtaining a key pair. The certification authority thus provides every subject with a key pair and a certificate for the corresponding public key.</p>
<p>This fact is a practical necessity because subjects usually do not have the required technical skills. Of course, certification authority must be trusted to not retain a copy of the private keys that they distribute.</p>
<h2 id="self-signed-certificates">Self-signed certificates</h2>
<p>A self-signed certificate is one in which subject and issuer are identical. The signature of a self-signed certificate is verified with the public key in the certificate.</p>
<p>Any subject may construct a self-signed certificate for any other subject and such that the signature on the certificate is valid. To this end, the subject only needs to:
1. Generate a new public-private key pair.
2. Construct a certificate associating the newly-created public key with any arbitrary subject (i.e., specifying an arbitrary value for the fields “subject” and “issuer” to be written in the certificate).
3. Sign the certificate with the newly-created private key.
The key point is that <em>any </em>subject can be specified at step 2. The signature on the certificate will be valid, as long as the certificate is not modified. This fact is not surprising because a byte sequence with a valid signature may or may not contain a true proposition.</p>
<p>A self-signed certificate, thus, does not provide any guarantee on whether it describes a real association. A valid signature on a self-signed certificate only provides authenticity and integrity, with authenticity meaning that the certificate was signed with the private key companion of the public key in the certificate. Authenticity does not mean that the content of the certificate contains a true proposition (i.e., a real association).</p>
<p>Let S be a subject that receives a self-signed certificate. In practice:
* If the certificate was received on CS then the certificate is assumed to describe a real association.
* If the certificate was received on C, then the software asks the subject how to proceed (or may be configured to take on the choices below automatically):
1. Do not use the self-signed certificate.
2. Use the self-signed certificate, only once.
3. Use the self-signed certificate and store the certificate in the KeySet and TrustSet.
The subject should make a choice based on its degree of confidence that the received self-signed certificate indeed contains a real association. Of course, such a degree of confidence will be much lower than what typically obtained on CS.</p>
<h2 id="keyset-and-trustset_1">KeySet and TrustSet</h2>
<p>CS is an abstraction that models the transmission of public keys of certification authorities from each certification authority to devices. As observed above, it is impossible to mathematically <em>prove </em>that CS indeed provides the required security properties (i.e., that KeySet indeed contains the real public keys of certification authorities). One can only obtain a high degree of confidence that CS provides those properties even in the presence of attacks.</p>
<p>Elements of the KeySet and of the TrustSet are self-signed certificates. This fact is due to technical reasons that are irrelevant to our discussion.</p>
<p>KeySet and TrustSet are part of the operating system. Thus, CS includes the distribution, installation, configuration and maintenance of the operating system on the device. Furthermore, it is the operating system that specifies which certification authorities are trusted.</p>
<p>The content of KeySet and TrustSet must be carefully protected from fraudulent modification: an attacker could modify the public key of a certification authority in the KeySet as well as insert other (attacker-controlled) certification authorities in the TrustStore. Attacks on these sets may occur during fabrication, installation, configuration, usage of the device. Those attacks correspond to a threat model different from a network attacker, however.</p>
<p>The actual implementation of KeySet and TrustSet depend on the operating system. In practice, these sets appear with terminology and structure different from the one used in this document.</p>
<h3 id="key-storage-in-practice">Key storage in practice</h3>
<p>The actual implementation of KeySet, TrustSet, PersonalSet in practice is quite intricate. We provide this information only for completeness of discussion.</p>
<p>In Windows, KeySet and TrustSet appear as a single set; this set can be accessed from Control Panel, Internet Options, Content, Certificates, in the tab named “Trusted Root Certification Authorities” (“Autorità di Certificazione Radice Attendibile”). The PersonalSet can be accessed in the same way, in the tab named “Personal”.</p>
<p>In Java, KeySet and TrustSet can be kept separate. A Java program must be associated with a property called TrustStore whose value is the name of a file containing the TrustSet. This file must follow a Java-specific format called keystore. A Java program must be associated also with a property called KeyStore, whose value is the name of a keystore file containing the PersonalSet (if the PersonalSet is empty then the KeyStore property is never used).</p>
<p>Certificates received on C that have been validated can be stored in the device, so that the public key of the corresponding subject will be always available locally. In Windows, these certificates are stored in the tab named “Other users”; in Java, these certificates must be stored in the file specified as KeyStore.</p>
<p>In other words, in Java there is a set containing the public keys of trusted certification authorities (TrustStore) and a set containing the keypair(s) of the user and the public keys of other subjects (KeyStore). Certificates in the KeyStore must be signed by subjects in the TrustStore.
PGP uses yet a different structure than either Windows or Java.</p>


  




                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.407015b8.min.js"></script>
      
    
  </body>
</html>